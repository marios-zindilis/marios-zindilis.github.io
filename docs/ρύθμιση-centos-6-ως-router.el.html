<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Marios Zindilis - Ρύθμιση CentOS 6 ως Router</title>
  <meta name="description" content="Αυτός ο οδηγός περιγράφει τη ρύθμιση ενός συστήματος με CentOS 6 ώστε να λειτουργεί ως δρομολογητής δικτύου (router). Έχει ελεγχθεί ότι δουλεύει σε «φρέσκια»...">
  <link
    rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css"
    integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/static/css/zindilis.com.css">
  <link rel="canonical" href="https://zindilis.com/docs/%CF%81%CF%8D%CE%B8%CE%BC%CE%B9%CF%83%CE%B7-centos-6-%CF%89%CF%82-router.el.html">
  <link rel="alternate" type="application/rss+xml" title="Marios Zindilis" href="https://zindilis.com/feed.xml">
  
  <meta property="og:title" content="Ρύθμιση CentOS 6 ως Router">


  <meta property="og:type" content="article">

  <meta property="og:article:published_time" content="2012-04-21">


  
    <meta property="og:article:modified_time" content="2012-04-21">
  





</head>


<body>
  <header class="mb-4">
  <nav class="navbar navbar-expand-md navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="/">Marios Zindilis</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-link-items" aria-controls="navbar-link-items" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbar-link-items">
        <div class="navbar-nav ml-auto">
          <a class="nav-item nav-link" style="color:white" href="/docs/">Docs</a>
          <a class="nav-item nav-link" style="color:white" href="/projects/">Projects</a>
          <a class="nav-item nav-link" style="color:white" href="/about/">About</a>
        </div>
      </div>
    </div>
  </nav>
</header>


  <div class="container">
        <article itemscope itemtype="http://schema.org/Article">

  <header>
    <h1 itemprop="name headline">Ρύθμιση CentOS 6 ως Router</h1>
  </header>

  <section itemprop="articleBody">
    <p>Αυτός ο οδηγός περιγράφει τη ρύθμιση ενός συστήματος με CentOS 6 ώστε να 
λειτουργεί ως δρομολογητής δικτύου (router). Έχει ελεγχθεί ότι δουλεύει 
σε «φρέσκια» εγκατάσταση του λειτουργικού, ενημερωμένη στα πιο πρόσφατα 
πακέτα που διατίθενται στα βασικά αποθετήρια. Δεν αποκλείεται να δουλεύει 
σε προηγούμενες εκδόσεις του CentOS ή σε άλλες διανομές βασισμένες σε 
RedHat. </p>

<h2>Υλικό</h2>

<p>Ένα σύστημα το οποίο προορίζεται να λειτουργήσει ως δρομολογητής, τυπικά 
χρειάζεται τουλάχιστον δύο κάρτες δικτύου. Κατά τα άλλα, δεν χρειάζεται άλλο 
υλικό.</p>

<p>Σημείωση: Είναι δυνατή η δρομολόγηση μεταξύ διαφορετικών δικτύων από την ίδια 
κάρτα δικτύου, αλλά αυτό δεν περιγράφεται σε αυτόν τον οδηγό. </p>

<h2>Λογισμικό</h2>

<p>Το λογισμικό που απαιτείται βρίσκεται ήδη στην βασική εγκατάσταση του 
CentOS 6. Σε αυτόν τον οδηγό χρησιμοποιείται η υπηρεσία <code>network</code> για 
ρύθμιση των διεπαφών δικτύου, ο πυρήνας <code>Linux</code> για τη δρομολόγηση, 
και το <code>iptables</code> για <abbr title="Network Address Translation">NAT</abbr>. </p>

<h2>Ρυθμίσεις</h2>

<p>Πριν από άλλες ρυθμίσεις, προσωπικά προτιμώ να απενεργοποιώ τον 
NetworkManager και να ενεργοποιώ την υπηρεσία <code>network</code>. Αυτό είναι 
προαιρετικό για τη συνέχεια του οδηγού:</p>
<div class="highlight"><pre><code class="language-" data-lang="">chkconfig NetworkManager off
service NetworkManager stop
chkconfig network on
service network start
</code></pre></div>
<h2>Παραμετροποίηση διεπαφών δικτύου </h2>

<p>Το σύστημα αναφοράς έχει δύο διεπαφές δικτύου, τις <code>eth0</code> και <code>eth1</code>. Η 
πρώτη έχει μια public διεύθυνση IP, την 77.88.99.111, την οποία αναθέτει 
ο πάροχος υπηρεσιών διαδικτύου. Η δεύτερη έχει την ιδιωτική διεύθυνση 
192.168.1.1, η οποία θα είναι και το default gateway για τα υπόλοιπα 
συστήματα στο εσωτερικό δίκτυο.</p>

<p>Ολόκληρο το αρχείο παραμετροποίησης της <code>eth0</code>:</p>
<div class="highlight"><pre><code class="language-" data-lang="">[root@centos6 ~]$ cat /etc/sysconfig/network-scripts/ifcfg-eth0
TYPE=Ethernet
BOOTPROTO=none
DEFROUTE=yes
IPV4_FAILURE_FATAL=yes
IPV6INIT=no
NAME=eth0
UUID=d30441e3-4212-4b24-b25a-d9c36b0aebd6
ONBOOT=yes
HWADDR=00:1C:C0:0D:36:C6
IPADDR=78.158.136.212
PREFIX=24
GATEWAY=78.158.136.254
NM_CONTROLLED=no
</code></pre></div>
<p>Ολόκληρο το αρχείο παραμετροποίησης της <code>eth1</code>:</p>
<div class="highlight"><pre><code class="language-" data-lang="">[root@centos6 ~]$ cat /etc/sysconfig/network-scripts/ifcfg-eth1
TYPE=Ethernet
BOOTPROTO=none
DEFROUTE=no
IPV4_FAILURE_FATAL=yes
IPV6INIT=no
NAME=eth1
ONBOOT=yes
HWADDR=00:05:5D:2E:FF:65
IPADDR=192.168.1.254
PREFIX=24
GATEWAY=192.168.1.254
NM_CONTROLLED=no
</code></pre></div>
<p>Μερικές από τις παραμέτρους εξηγούνται <a href="/docs/etc-sysconfig-network-scripts-ifcfg-eth0.el.html">εδώ</a>. 
Για αυτόν τον οδηγό, ειδική σημασία έχει κυρίως η παράμετρος DEFROUTE, η 
οποία καθορίζει κατά πόσο θα δημιουργείται αυτόματα μια προεπιλεγμένη 
διαδρομή δικτύου (default route) κατά την ενεργοποίηση της διεπαφής. 
Στην διεπαφή με την δημόσια IP η τιμή είναι &quot;yes&quot;, στην άλλη &quot;no&quot;. </p>

<h2>Παραμετροποίηση πυρήνα</h2>

<p>Τέλος, για να επιτρέπεται η ροή πακέτων δικτύου από τη μια διεπαφή στην 
άλλη, και από συστήματα στο εσωτερικό δίκτυο προς το διαδίκτυο, πρέπει 
να κάνετε μερικές αλλαγές στους κανόνες του <code>iptables</code>. Αν εξετάσετε 
την αρχική ρύθμιση στο αρχείο <code>/etc/sysconfig/iptables</code> θα δείτε τη 
γραμμή:</p>
<div class="highlight"><pre><code class="language-" data-lang="">-A FORWARD -j REJECT --reject-with icmp-host-prohibited
</code></pre></div>
<p>Αφαιρέστε την, για να επιτρέπεται η προώθηση πακέτων:</p>
<div class="highlight"><pre><code class="language-" data-lang="">[root@centos6 ~]$ iptables -t filter -D FORWARD -j REJECT --reject-with icmp-host-prohibited
</code></pre></div>
<p>Δύο ακόμη κανόνες χρειάζονται για να επιτρέπεται η ροή δικτύου μεταξύ των δύο διεπαφών:</p>
<div class="highlight"><pre><code class="language-" data-lang="">[root@centos6 ~]$ iptables -t filter -A FORWARD -i eth1 -o eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
[root@centos6 ~]$ iptables -t filter -A FORWARD -i eth0 -o eth1 -j ACCEPT
</code></pre></div>
<p>Ρύθμιση NAT:</p>
<div class="highlight"><pre><code class="language-" data-lang="">[root@centos6 ~]$ iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
</code></pre></div>
<p>Προσέξτε ότι στην ρύθμιση NAT, χρησιμοποιείται η διεπαφή δικτύου που έχει την δημόσια IP.</p>

<h2>Σύνοψη</h2>

<p>Με τις ρυθμίσεις που περιγράφηκαν στο πιο πάνω άρθρο μπορείτε να χρησιμοποιήσετε έναν υπολογιστή με δύο κάρτες δικτύου ως δρομολογητή (router). Με μερικές ακόμη προσθήκες (καλή ρύθμιση firewall, προσθήκη εξυπηρετητή DHCP, κ.α), ένα σύστημα ταπεινών επιδόσεων μπορεί να εξυπηρετεί λαμπρά ως σπιτικό gateway προς το διαδίκτυο. </p>

  </section>

  <footer id="post-footer">
  
    First Published: <time datetime="2012-04-21T00:00:00+01:00" itemprop="datePublished">2012-04-21</time>
  
  
    
      &middot; Last Modified: <time datetime="2012-04-21T00:00:00+01:00" itemprop="dateModified">2012-04-21</time>
    
  

  <span itemprop="author" itemscope itemtype="http://schema.org/Person">
  
    &middot; Author: <span itemprop="name">Marios Zindilis</span>
  
  </span>
  </footer>
</article>

  </div>

  <footer id="site-footer" class="footer-distributed">
  <div class="container">
    <div class="footer-right">
      <a href="/feed.xml" title="Marios Zindilis RSS Feed">
        <i class="fa fa-rss" aria-hidden="true"></i><span class="sr-only">Marios Zindilis RSS Feed</span></a>
      <a href="https://www.linkedin.com/in/zindilis" title="Marios Zindilis LinkedIn Profile">
        <i class="fa fa-linkedin" aria-hidden="true"></i><span class="sr-only">Marios Zindilis LinkedIn Profile</span></a>
      <a href="https://github.com/marios-zindilis" title="Marios Zindilis GitHub Page">
        <i class="fa fa-github" aria-hidden="true"></i><span class="sr-only">Marios Zindilis GitHub Page</span></a>
    </div>

    <div class="footer-left">
      <p class="footer-links">
        <a href="/">Home</a> · 
        <a href="/docs/">Docs</a> ·
        <a href="/projects/">Projects</a> ·
        <a href="/about/">About</a>
      </p>
      <p>Marios Zindilis</p>
    </div>
  </div>
</footer>

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
    <script type="text/javascript">
      // set padding-bottom of body to height of footer.site-footer:
      document.body.style.marginBottom = document.getElementById("site-footer").clientHeight + "px";
      // http://stackoverflow.com/a/14570614
      var observeDOM = (function(){
        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver,
          eventListenerSupported = window.addEventListener;

        return function(obj, callback){
          if( MutationObserver ){
          // define a new observer
            var obs = new MutationObserver(function(mutations, observer){
              if( mutations[0].addedNodes.length || mutations[0].removedNodes.length )
              callback();
            });
            // have the observer observe foo for changes in children
            obs.observe( obj, { childList:true, subtree:true });
          }
          else if( eventListenerSupported ){
            obj.addEventListener('DOMNodeInserted', callback, false);
            obj.addEventListener('DOMNodeRemoved', callback, false);
          }
        }
      })();
      observeDOM(document.getElementById('site-footer') ,function(){
        document.body.style.marginBottom = document.getElementById("site-footer").clientHeight + "px";
      });
    </script>


  </body>
</html>
