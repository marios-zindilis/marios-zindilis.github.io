<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Marios Zindilis - MediaWiki: Διαγραφή άρθρου από τη βάση δεδομένων</title>
  <meta name="description" content="Οδηγός διαγραφής άρθρου από τη βάση δεδομένων του MediaWiki">

  <link
    rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/css/bootstrap.min.css"
    integrity="sha384-AysaV+vQoT3kOAXZkl02PThvDr8HYKPZhNT5h/CXfBThSRXQ6jW5DO2ekP5ViFdi"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/static/css/zindilis.com.css">
  <link rel="canonical" href="https://zindilis.com/blog/2011/08/15/mediawiki-%CE%B4%CE%B9%CE%B1%CE%B3%CF%81%CE%B1%CF%86%CE%AE-%CE%AC%CF%81%CE%B8%CF%81%CE%BF%CF%85-%CE%B1%CF%80%CF%8C-%CE%B2%CE%AC%CF%83%CE%B7-%CE%B4%CE%B5%CE%B4%CE%BF%CE%BC%CE%AD%CE%BD%CF%89%CE%BD.el.html">
  <link rel="alternate" type="application/rss+xml" title="Marios Zindilis" href="https://zindilis.com/feed.xml">
  
  <meta property="og:title" content="MediaWiki: Διαγραφή άρθρου από τη βάση δεδομένων">


  <meta property="og:type" content="article">

  <meta property="og:article:published_time" content="2011-08-15">


  
    <meta property="og:article:modified_time" content="2011-08-15">
  




  <meta property="og:description" content="Οδηγός διαγραφής άρθρου από τη βάση δεδομένων του MediaWiki">


</head>


<body>
  <header class="site-header">
  <nav class="navbar navbar-fixed-top" style="border-bottom: 1px solid; background-color: white;">
    <div class="container">
      <a class="navbar-brand fload-md-left float-xs-none" href="/">Marios Zindilis</a>
      <ul class="nav navbar-nav float-md-right">
        <li class="nav-item">
          <a class="nav-link" href="/docs/">Docs</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/projects/">Projects</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/about/">About</a>
        </li>
      </ul>
    </div>
  </nav>
</header>


  <div class="container">
        <article itemscope itemtype="http://schema.org/BlogPosting">

  <header>
    <h1 itemprop="name headline">MediaWiki: Διαγραφή άρθρου από τη βάση δεδομένων</h1>
    <p class="post-meta">
      <time datetime="2011-08-15T00:00:00+01:00" itemprop="datePublished">2011-08-15</time>
      • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Marios Zindilis</span></span>
    </p>
  </header>

  <section itemprop="articleBody">
    <p>Υπάρχουν περιπτώσεις στο MediaWiki που ένα άρθρο δεν μπορεί να διαγραφεί μέσω της συνηθισμένης διεπαφής, οπότε χρειάζεται σκάλισμα της βάσης δεδομένων. Αυτός ο οδηγός περιγράφει τον τρόπο.</p>

<p>Προτού προχωρήσετε σε οποιαδήποτε παρέμβαση στη βάση δεδομένων σας, οπωσδήποτε πρέπει να κρατήσετε ένα <strong>αντίγραφο ασφαλείας</strong> ολόκληρης της βάσης. Επίσης, αν το Wiki σας έχει έντονη δραστηριότητα, μπορείτε προσωρινά να αποτρέψετε οποιεσδήποτε αλλαγές στις σελίδες, προσθέτωντας μια γραμμή στο αρχείο LocalSettings.php: <code>$wgReadOnly = 'Το Wiki είναι προσωρινά μη διαθέσιμο για επεξεργασία.';</code>.</p>

<h3>Δομή της βάσης δεδομένων</h3>
<p>Η δομή της βάσης δεδομένων του MediaWiki υπάρχει στην τεκμηρίωση, στο άρθρο <a href="http://www.mediawiki.org/wiki/Manual:Database_layout">Database Layout</a>. Για το κάθε άρθρο που εμφανίζεται στο Wiki εμπλέκονται τουλάχιστον τρεις από τους πίνακες της βάσης:</p>
<ol><li>Στον πίνακα <strong>page</strong> αποθηκεύεται μια λίστα με τους τίτλους όλων των άρθρων. Όταν χρειάζεται να εμφανιστεί ένα άρθρο, γίνεται αναζήτηση σε αυτόν τον πίνακα με βάση τον τίτλο, και ανακτάται η τιμή του πεδίου <code>page_latest</code>.</li>
<li>Με την τιμή <code>page_latest</code> γίνεται αναζήτηση στον πίνακα <strong>revision</strong>. Σ' αυτόν τον πίνακα αποθηκεύονται μερικά <em>μεταδεδομένα</em> (δηλαδή όχι καθαυτό το περιεχόμενο) για κάθε αλλαγή που γίνεται στο Wiki. Για να εμφανιστεί ένα άρθρο, από αυτόν τον πίνακα ανακτούνται οι τιμές <code>rev_id</code> και <code>rev_text_id</code>.</li>
<li>Τέλος, με την τιμή <code>rev_text_id</code> που βρέθηκε στο προηγούμενο βήμα, γίνεται αναζήτηση στον πίνακα <strong>text</strong>, και ανακτάται η τιμή του πεδίου <code>old_text</code>, η οποία αποτελεί και το περιεχόμενο του άρθρου. Ο πίνακας <strong>text</strong> αποθηκεύει ολόκληρο το περιεχόμενο από κάθε αναθεώρηση κάθε άρθρου του Wiki.</li>
</ol>
<h3>Διαγραφή των καταχωρήσεων</h3>
<p>Το πρώτο βήμα είναι να αναζητήσετε τον τίτλο του άρθρου στον πίνακα <strong>page</strong>, στη στήλη <code>page_title</code>. Οι τίτλοι αποθηκεύονται με τα διαστήματα αλλαγμένα σε κάτω παύλες (underscore) και με τους χαρακτήρες ειδικά διαμορφωμένους σε δεκαεξαδικούς χαρακτήρες UTF-8, αν περιέχεται στον τίτλο χαρακτήρας άλλος από τα Αγγλικά. Δυστυχώς, δεν έχω βρει εύκολο τρόπο να κάνετε τη μετατροπή. Μπορείτε να αναζητήσετε στο διαδίκτυο για βοηθήματα, όπως για παράδειγμα αυτός ο <a href="http://rocky.uta.edu/doran/charsets/charsets.cgi?map=marc2unicode&amp;table=8">πίνακας μετατροπής χαρακτήρων</a>. Εναλλακτικά, αν χρησιμοποιείτε κάποιο πρόγραμμα όπως το PhpMyAdmin, μπορείτε να εξάγετε ολόκληρο τον πίνακα σε CSV, να τον ανοίξετε με ένα πρόγραμμα όπως το OpenOffice Calc και να δείτε τα περιεχόμενά του κανονικά.</p>

<p>Όταν βρείτε τον τίτλο που θέλετε, σημειώστε την τιμή του πεδίου <code>page_id</code> που αντιστοιχεί στον τίτλο, και διαγράψτε αυτή τη γραμμή από τον πίνακα, εκτελώντας κάτι σαν <code>DELETE FROM my_database.mw_page WHERE mw_page.page_id = 1234</code>. Από αυτή τη στιγμή και μετά, η σελίδα δεν είναι διαθέσιμη στο Wiki, το περιεχόμενό της όμως παραμένει στη βάση δεδομένων.</p>

<p>Για να εξαφανιστεί εντελώς η σελίδα από τη βάση δεδομένων και να μην μείνουν «σπασμένες» αναφορές σ’ αυτήν, θα πρέπει να διαγράψετε και όλες τις αναθεωρήσεις της από τον πίνακα <strong>revision</strong>, καθώς και όλα τα αλλαγμένα κείμενα από τον πίνακα <strong>text</strong>.</p>

<p>Μπορείτε να δείτε όλες τις αναθεωρήσεις που θα διαγραφούν, εκτελώντας κάτι σαν <code>SELECT * FROM mw_revision WHERE mw_revision.rev_page = 1234</code>, αλλά προτού τις διαγράψετε, θα χρειαστείτε τα αντίστοιχα <code>rev_text_id</code>, τα οποία θα τα χρησιμοποιήσετε αργότερα. Για να τα δείτε, εκτελέστε <code>SELECT rev_text_id FROM my_database.mw_revision WHERE mw_revision.rev_page = 1234</code>. Κρατήστε κάπου ξεχωριστά αυτό το αποτέλεσμα, θα σας χρειαστεί μετά. Τώρα μπορείτε να διαγράψετε τις αναθεωρήσεις, εκτελώντας κάτι σαν <code>DELETE FROM my_database.mw_revision WHERE mw_revision.rev_page = 1234</code>.</p>

<p>Τέλος, από τον πίνακα <strong>text</strong> θα πρέπει να διαγράψετε τα κείμενα των παλιών αναθεωρήσεων της σελίδας. Το πεδίο <code>old_id</code> αυτού του πίνακα, είναι ίδιο με το <code>rev_text_id</code> που κρατήσατε προηγουμένως. Μπορείτε λοιπόν να διαγράψετε ένα ένα τα κείμενα, εκτελώντας επανηλειμμένα κάτι σαν <code>DELETE FROM my_database.mw_text WHERE mw_text.old_id = 100</code>, αλλάζωντας το «100» σε ό,τι αντιστοιχεί στα δικά σας δεδομένα.</p>

  </section>

  <footer id="post-footer">
  
    Last modified: <span itemprop="dateModified">2011-08-15</span>
  
  
    &ndash; License: <a href="https://creativecommons.org/licenses/by-sa/4.0/" itemprop="license" title="Creative Commons Attribution-ShareAlike 4.0 International">CC-BY-SA-4.0</a>
  
  </footer>

</article>

  </div>

  <footer id="site-footer" class="footer-distributed">
  <div class="container">
    <div class="footer-right">
      <a href="/feed.xml" title="Marios Zindilis RSS Feed">
        <i class="fa fa-rss" aria-hidden="true"></i><span class="sr-only">Marios Zindilis RSS Feed</span></a>
      <a href="https://www.facebook.com/zindilis" title="Marios Zindilis Facebook">
        <i class="fa fa-facebook" aria-hidden="true"></i><span class="sr-only">Marios Zindilis Facebook</span></a>
      <a href="https://twitter.com/MariosZindilis" title="Marios Zindilis Twitter">
        <i class="fa fa-twitter" aria-hidden="true"></i><span class="sr-only">Marios Zindilis Twitter</span></a>
      <a href="https://www.linkedin.com/in/zindilis" title="Marios Zindilis LinkedIn Profile">
        <i class="fa fa-linkedin" aria-hidden="true"></i><span class="sr-only">Marios Zindilis LinkedIn Profile</span></a>
      <a href="https://github.com/marios-zindilis" title="Marios Zindilis GitHub Page">
        <i class="fa fa-github" aria-hidden="true"></i><span class="sr-only">Marios Zindilis GitHub Page</span></a>
    </div>

    <div class="footer-left">
      <p class="footer-links">
        <a href="/">Home</a> · 
        <a href="/docs/">Docs</a> ·
        <a href="/projects/">Projects</a> ·
        <a href="/about/">About</a>
      </p>
      <p>Marios Zindilis</p>
    </div>
  </div>
</footer>

      <script
      src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"
      integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7"
      crossorigin="anonymous"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js"
      integrity="sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8"
      crossorigin="anonymous"></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/js/bootstrap.min.js"
      integrity="sha384-BLiI7JTZm+JWlgKa0M0kGRpJbF2J8q+qreVrKBC47e3K6BW78kGLrCkeRX6I9RoK"
      crossorigin="anonymous"></script>
    <script type="text/javascript">
      // set padding-bottom of body to height of footer.site-footer:
      document.body.style.marginBottom = document.getElementById("site-footer").clientHeight + "px";
      // http://stackoverflow.com/a/14570614
      var observeDOM = (function(){
        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver,
          eventListenerSupported = window.addEventListener;

        return function(obj, callback){
          if( MutationObserver ){
          // define a new observer
            var obs = new MutationObserver(function(mutations, observer){
              if( mutations[0].addedNodes.length || mutations[0].removedNodes.length )
              callback();
            });
            // have the observer observe foo for changes in children
            obs.observe( obj, { childList:true, subtree:true });
          }
          else if( eventListenerSupported ){
            obj.addEventListener('DOMNodeInserted', callback, false);
            obj.addEventListener('DOMNodeRemoved', callback, false);
          }
        }
      })();
      observeDOM(document.getElementById('site-footer') ,function(){
        document.body.style.marginBottom = document.getElementById("site-footer").clientHeight + "px";
      });
    </script>


  </body>
</html>
